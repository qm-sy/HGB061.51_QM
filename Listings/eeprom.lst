C51 COMPILER V9.60.7.0   EEPROM                                                            11/19/2024 16:38:29 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE EEPROM
OBJECT MODULE PLACED IN .\Output\eeprom.obj
COMPILER INVOKED BY: D:\APP\Keil_v5\C51\BIN\C51.EXE Src\eeprom.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Inc;D:\APP\Keil
                    -_v5\C51\INC) DEBUG OBJECTEXTEND PRINT(.\Listings\eeprom.lst) OBJECT(.\Output\eeprom.obj)

line level    source

   1          #include "STC15W4Kxx.h"
   2          #include "eeprom.h"
   3          #include "stdint.h"
   4          #include "delay.h"
   5          
   6          void ISPIdle()
   7          {
   8   1          IAP_CONTR = 0X00;
   9   1          IAP_CMD = 0X00;
  10   1          IAP_TRIG = 0X00;
  11   1          IAP_ADDRH = 0X80;
  12   1          IAP_ADDRL = 0X00; 
  13   1      }
  14          
  15          uint8_t ISP_read(uint16_t addr)
  16          {
  17   1          uint8_t dat;
  18   1          
  19   1          IAP_CONTR = 0X83;
  20   1          IAP_CMD = 0X01;
  21   1          IAP_ADDRL = addr;
  22   1          IAP_ADDRH = addr>>8;
  23   1          
  24   1          IAP_TRIG = 0X5A;
  25   1          IAP_TRIG = 0XA5;
  26   1          
  27   1          delay_ms(10);
  28   1          
  29   1          dat = IAP_DATA;
  30   1          
  31   1          ISPIdle();
  32   1          
  33   1          return dat;
  34   1      }
  35          
  36          void ISP_write(uint16_t addr,uint8_t dat)
  37          {
  38   1          IAP_CONTR = 0X83;
  39   1          IAP_CMD = 0X02;
  40   1          IAP_ADDRL = addr;
  41   1          IAP_ADDRH = addr>>8;
  42   1          IAP_DATA = dat;
  43   1          
  44   1          IAP_TRIG = 0X5A;
  45   1          IAP_TRIG = 0XA5;
  46   1          
  47   1          delay_ms(10);
  48   1          
  49   1          ISPIdle();
  50   1      }
  51          
  52          void ISP_earse(uint16_t addr)
  53          {   
  54   1          IAP_CONTR = 0X83;   //  WT2:WT1:WT0 = 0 1 1  CPUµÈ´ýÊ±¼ä>=12MHz
C51 COMPILER V9.60.7.0   EEPROM                                                            11/19/2024 16:38:29 PAGE 2   

  55   1          IAP_CMD = 0X03;
  56   1          IAP_ADDRL = addr;
  57   1          IAP_ADDRH = addr>>8;
  58   1          
  59   1          IAP_TRIG = 0X5A;
  60   1          IAP_TRIG = 0XA5;
  61   1          
  62   1          delay_ms(10);
  63   1          
  64   1          ISPIdle();
  65   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    100    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
